---
import { urlFor } from '../../lib/sanityImage';
import { resolveWorkRefs } from '../../lib/resolveWorkRefs';

const { node } = Astro.props;
const works = await resolveWorkRefs(node.works);
---
<section class="pb-48 pt-12 min-h-section border-t border-gray-200 dark:border-gray-800">
  <div class="pb-6">
    {node.title}
  </div>
  <div class="grid grid-cols-1 sm:grid-cols-2 gap-x-6 gap-y-12">
    {works.map((work) => (
      <a href={`/work/${work.slug.current}`}>
        <img
          src={urlFor(work.image).width(684).format('webp').url()}
          srcset={`
            ${urlFor(work.image).width(684).format('webp').url()} 684w,
            ${urlFor(work.image).width(1368).format('webp').url()} 1368w,
          `}
          sizes="(max-width: 1440px) 100vw, 684px"
          alt={work.image.alt || ''}
          loading="lazy"
          decoding="async"
          slot="media"
          class="w-full h-auto mb-3"
        />
        {work.title}
        <div class="text-gray-500">{work.subline}</div>
      </a>
    ))}
  </div>
</section>
